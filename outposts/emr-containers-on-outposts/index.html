
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>EMR on EKS(AWS Outposts) - EMR Containers Best Practices Guides</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-emr-containers-on-aws-outposts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EMR Containers Best Practices Guides" class="md-header__button md-logo" aria-label="EMR Containers Best Practices Guides" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EMR Containers Best Practices Guides
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              EMR on EKS(AWS Outposts)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws/aws-emr-containers-best-practices/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aws/aws-emr-containers-best-practices
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link md-tabs__link--active">
        Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../security/docs/spark/encryption/" class="md-tabs__link">
        Security
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../submit-applications/docs/spark/pyspark/" class="md-tabs__link">
        Submit applications
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../storage/docs/spark/ebs/" class="md-tabs__link">
        Storage
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../metastore-integrations/docs/hive-metastore/" class="md-tabs__link">
        Metastore Integration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../debugging/docs/change-log-level/" class="md-tabs__link">
        Debugging
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../troubleshoot/docs/pvc-permission/" class="md-tabs__link">
        Troubleshoot
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../node-placement/docs/eks-node-placement/" class="md-tabs__link">
        Node Placement
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../performance/docs/dra/" class="md-tabs__link">
        Performance
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../spot-instances-resiliency/docs/copying-shuffle-data/" class="md-tabs__link">
        Spot instances resiliency
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EMR Containers Best Practices Guides" class="md-nav__button md-logo" aria-label="EMR Containers Best Practices Guides" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    EMR Containers Best Practices Guides
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws/aws-emr-containers-best-practices/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aws/aws-emr-containers-best-practices
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          EMR on EKS(AWS Outposts)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        EMR on EKS(AWS Outposts)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-considerations-and-recommendations" class="md-nav__link">
    Key Considerations and Recommendations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infrastructure-setup" class="md-nav__link">
    Infrastructure Setup
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-eks-on-outposts" class="md-nav__link">
    Setup EKS on Outposts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-cluster-with-emr-containers" class="md-nav__link">
    Register cluster with EMR Containers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Security" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/docs/spark/encryption/" class="md-nav__link">
        Encryption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/docs/spark/data-encryption/" class="md-nav__link">
        Data Encryption
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Submit applications
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Submit applications" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Submit applications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submit-applications/docs/spark/pyspark/" class="md-nav__link">
        Pyspark
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/docs/spark/ebs/" class="md-nav__link">
        EBS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/docs/spark/fsx-lustre/" class="md-nav__link">
        FSx for Lustre
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Metastore Integration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Metastore Integration" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Metastore Integration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metastore-integrations/docs/hive-metastore/" class="md-nav__link">
        Hive Metastore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metastore-integrations/docs/aws-glue/" class="md-nav__link">
        AWS Glue
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Debugging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Debugging" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Debugging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debugging/docs/change-log-level/" class="md-nav__link">
        Change Log Level
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../debugging/docs/connect-spark-ui/" class="md-nav__link">
        Connect to Spark UI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Troubleshoot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Troubleshoot" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Troubleshoot
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshoot/docs/pvc-permission/" class="md-nav__link">
        PVC permission
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Node Placement
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Node Placement" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Node Placement
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../node-placement/docs/eks-node-placement/" class="md-nav__link">
        EKS Node placement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../node-placement/docs/fargate-node-placement/" class="md-nav__link">
        EKS Fargate Node placement
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Performance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Performance" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Performance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../performance/docs/dra/" class="md-nav__link">
        Dynamic Resource Allocation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../best-practices-and-recommendations/eks-best-practices/" class="md-nav__link">
        EKS Best Practices
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Spot instances resiliency
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Spot instances resiliency" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Spot instances resiliency
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spot-instances-resiliency/docs/copying-shuffle-data/" class="md-nav__link">
        Copying Shuffle data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-considerations-and-recommendations" class="md-nav__link">
    Key Considerations and Recommendations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infrastructure-setup" class="md-nav__link">
    Infrastructure Setup
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-eks-on-outposts" class="md-nav__link">
    Setup EKS on Outposts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-cluster-with-emr-containers" class="md-nav__link">
    Register cluster with EMR Containers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/aws/aws-emr-containers-best-practices/edit/master/docs/outposts/emr-containers-on-outposts.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="running-emr-containers-on-aws-outposts">Running EMR Containers on AWS Outposts<a class="headerlink" href="#running-emr-containers-on-aws-outposts" title="Permanent link">&para;</a></h1>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>You can now run Amazon EMR container jobs on EKS clusters that are running on AWS Outposts. AWS Outposts enables native AWS services, infrastructure, and operating models in on-premises facilities. In AWS Outposts environments, you can use the same AWS APIs, tools, and infrastructure that you use in the AWS Cloud. Amazon EKS nodes on AWS Outposts is ideal for low-latency workloads that need to be run in close proximity to on-premises data and applications. For more information, see the Amazon EKS on Outposts <a href="https://docs.aws.amazon.com/eks/latest/userguide/eks-on-outposts.html">documentation page</a>.</p>
<p>This document provides the steps to set up EMR containers on AWS Outposts.</p>
<p><img alt="" src="../resources/outposts_eks_network.png" /></p>
<h2 id="key-considerations-and-recommendations">Key Considerations and Recommendations<a class="headerlink" href="#key-considerations-and-recommendations" title="Permanent link">&para;</a></h2>
<ul>
<li>The EKS cluster on an Outpost must be created with self-managed node groups.</li>
<li>Use the AWS Management Console and AWS CloudFormation to create a self-managed node group in Outposts.</li>
<li>For EMR workloads, we recommend creating EKS clusters where all the worker nodes reside in the self-managed node group of Outposts.</li>
<li>The Kubernetes client in the Spark driver pod creates and monitor executor pods by communicating with the EKS managed Kubernetes API server residing in the parent AWS Region. For reliable monitoring of executor pods during a job run, we also recommend having a reliable low latency link between the Outpost and the parent Region.</li>
<li>AWS Fargate is not available on Outposts.</li>
<li>For more information about the supported Regions, prerequisites and considerations for Amazon EKS on AWS Outposts, see the EKS on Outposts <a href="https://docs.aws.amazon.com/eks/latest/userguide/eks-on-outposts.html">documentation page</a>.</li>
</ul>
<h2 id="infrastructure-setup">Infrastructure Setup<a class="headerlink" href="#infrastructure-setup" title="Permanent link">&para;</a></h2>
<h3 id="setup-eks-on-outposts">Setup EKS on Outposts<a class="headerlink" href="#setup-eks-on-outposts" title="Permanent link">&para;</a></h3>
<p><strong>Network Setup</strong>  </p>
<ul>
<li>Setup a VPC</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">aws</span><span class="w"> </span><span class="n">ec2</span><span class="w"> </span><span class="n">create</span><span class="o">-</span><span class="n">vpc</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="o">--</span><span class="n">region</span><span class="w"> </span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="o">--</span><span class="n">cidr</span><span class="o">-</span><span class="n">block</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="mf">10.0.0.0</span><span class="o">/</span><span class="mh">16</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"></span>
</code></pre></div>

<p>In the output, take note of the VPC ID. </p>
<div class="codehilite"><pre><span></span><code>{
    &quot;Vpc&quot;: {
        &quot;VpcId&quot;: &quot;vpc-123vpc&quot;, 
        ...
    }
}
</code></pre></div>

<ul>
<li>Create two subnets in the parent Region.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">aws</span><span class="w"> </span><span class="n">ec2</span><span class="w"> </span><span class="n">create</span><span class="o">-</span><span class="n">subnet</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">region</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">availability</span><span class="o">-</span><span class="n">zone</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">usw2</span><span class="o">-</span><span class="n">az1</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">vpc</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">vpc</span><span class="o">-</span><span class="mh">123</span><span class="n">vpc</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">cidr</span><span class="o">-</span><span class="n">block</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="mf">10.0.1.0</span><span class="o">/</span><span class="mh">24</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"></span>

<span class="n">aws</span><span class="w"> </span><span class="n">ec2</span><span class="w"> </span><span class="n">create</span><span class="o">-</span><span class="n">subnet</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">region</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">availability</span><span class="o">-</span><span class="n">zone</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">usw2</span><span class="o">-</span><span class="n">az2</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">vpc</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">vpc</span><span class="o">-</span><span class="mh">123</span><span class="n">vpc</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">cidr</span><span class="o">-</span><span class="n">block</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="mf">10.0.2.0</span><span class="o">/</span><span class="mh">24</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"></span>
</code></pre></div>

<p>In the output, take note of the Subnet ID.</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;Subnet&quot;: {
        &quot;SubnetId&quot;: &quot;subnet-111&quot;,
        ...
    }
}
{
    &quot;Subnet&quot;: {
        &quot;SubnetId&quot;: &quot;subnet-222&quot;,
        ...
    }
}
</code></pre></div>

<ul>
<li>Create a subnet in the Outpost Availability Zone. (This step is different for Outposts)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">aws</span><span class="w"> </span><span class="n">ec2</span><span class="w"> </span><span class="n">create</span><span class="o">-</span><span class="n">subnet</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">region</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">availability</span><span class="o">-</span><span class="n">zone</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">usw2</span><span class="o">-</span><span class="n">az1</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">outpost</span><span class="o">-</span><span class="n">arn</span><span class="w"> </span><span class="p">&#39;</span><span class="nl">arn:aws:outposts:</span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;:&lt;</span><span class="mh">123456789</span><span class="o">&gt;:</span><span class="n">outpost</span><span class="o">/&lt;</span><span class="n">op</span><span class="o">-</span><span class="mh">123</span><span class="n">op</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">vpc</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">vpc</span><span class="o">-</span><span class="mh">123</span><span class="n">vpc</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">cidr</span><span class="o">-</span><span class="n">block</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="mf">10.0.3.0</span><span class="o">/</span><span class="mh">24</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"></span>
</code></pre></div>

<p>In the output, take note of the Subnet ID.</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;Subnet&quot;: {
        &quot;SubnetId&quot;: &quot;subnet-333outpost&quot;,
        &quot;OutpostArn&quot;: &quot;...&quot;
        ...
    }
}
</code></pre></div>

<p><strong>EKS Cluster Creation</strong> </p>
<ul>
<li>Create an EKS cluster using the three subnet Ids created earlier.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">aws</span><span class="w"> </span><span class="n">eks</span><span class="w"> </span><span class="n">create</span><span class="o">-</span><span class="n">cluster</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">region</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">name</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">outposts</span><span class="o">-</span><span class="n">eks</span><span class="o">-</span><span class="n">cluster</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">role</span><span class="o">-</span><span class="n">arn</span><span class="w"> </span><span class="p">&#39;</span><span class="nl">arn:aws:</span><span class="n">iam</span><span class="o">::&lt;</span><span class="mh">123456789</span><span class="o">&gt;:</span><span class="n">role</span><span class="o">/&lt;</span><span class="n">cluster</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">role</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">resources</span><span class="o">-</span><span class="n">vpc</span><span class="o">-</span><span class="n">config</span><span class="w">  </span><span class="n">subnetIds</span><span class="o">=</span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">subnet</span><span class="o">-</span><span class="mh">111</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">subnet</span><span class="o">-</span><span class="mh">222</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">subnet</span><span class="o">-</span><span class="mh">333</span><span class="n">outpost</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"></span>
</code></pre></div>

<ul>
<li>Check until the cluster status becomes active.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">aws</span><span class="w"> </span><span class="n">eks</span><span class="w"> </span><span class="n">describe</span><span class="o">-</span><span class="n">cluster</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">region</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mh">2</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"> </span><span class="se">\</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="n">name</span><span class="w"> </span><span class="p">&#39;</span><span class="o">&lt;</span><span class="n">outposts</span><span class="o">-</span><span class="n">eks</span><span class="o">-</span><span class="n">cluster</span><span class="o">&gt;</span><span class="p">&#39;</span><span class="w"></span>
</code></pre></div>

<p>Note the values of resourcesVpcConfig.clusterSecurityGroupId and identity.oidc.issuer.</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;cluster&quot;: {
        &quot;name&quot;: &quot;outposts-eks-cluster&quot;,
        ...
        &quot;resourcesVpcConfig&quot;: {
            &quot;clusterSecurityGroupId&quot;: &quot;sg-123clustersg&quot;,
        },
        &quot;identity&quot;: {
            &quot;oidc&quot;: {
                &quot;issuer&quot;: &quot;https://oidc.eks.us-west-2.amazonaws.com/id/oidcid&quot;
            }
        },
        &quot;status&quot;: &quot;ACTIVE&quot;,
    }
}
</code></pre></div>

<ul>
<li>Add the Outposts nodes to the EKS Cluster.</li>
</ul>
<p>At this point, eksctl cannot be used to launch self-managed node groups in Outposts. Please follow the steps listed in the self-managed nodes <a href="https://docs.aws.amazon.com/eks/latest/userguide/launch-workers.html#aws-management-console">documentation page</a>. In order to use the cloudformation script lised in the AWS Management Console tab, make note of the following values created in the earlier steps:
* ClusterName: <code>&lt;outposts-eks-cluster&gt;</code>
* ClusterControlPlaneSecurityGroup: <code>&lt;sg-123clustersg&gt;</code>
* Subnets: <code>&lt;subnet-333outpost&gt;</code></p>
<p>Apply the aws-auth-cm config map listed on the documentation page to allow the nodes to join the cluster.</p>
<h3 id="register-cluster-with-emr-containers">Register cluster with EMR Containers<a class="headerlink" href="#register-cluster-with-emr-containers" title="Permanent link">&para;</a></h3>
<p>Once the EKS cluster has been created and the nodes have been registered with the EKS control plane, take the <a href="https://docs.aws.amazon.com/emr/latest/EMR-on-EKS-DevelopmentGuide/getting-started.html">following steps</a>:</p>
<ul>
<li>Enable cluster access for Amazon EMR on EKS.</li>
<li>Enable IAM Roles for Service Accounts (IRSA) on the EKS cluster.</li>
<li>Create a job execution role.</li>
<li>Update the trust policy of the job execution role.</li>
<li>Grant users access to Amazon EMR on EKS.</li>
<li>Register the Amazon EKS cluster with Amazon EMR.</li>
</ul>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>EMR-EKS on Outposts allows users to run their big data jobs in close proximity to on-premises data and applications.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
        
        <a href="../../security/docs/spark/encryption/" class="md-footer__link md-footer__link--next" aria-label="Next: Encryption" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Encryption
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>